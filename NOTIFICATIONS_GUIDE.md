# ๐ ูุธุงู ุงูุฅุดุนุงุฑุงุช (Firebase Cloud Messaging)

ุชู ุฅุนุฏุงุฏ ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูุฏูุน ุงูุชูุจููุงุช ูููุณุชุฎุฏููู.

## โ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ (ููู ุฌุฏุงู):

1. **ููู `firebase_credentials.json`**:
   - ุงุญุตู ุนููู ูู: Firebase Console -> Project Settings -> Service accounts -> Generate new private key
   - ุถุนู ูู ุงููุณุงุฑ: `storage/app/firebase_credentials.json`

2. **ุชุญุฏูุซ ููู `.env` (ุงุฎุชูุงุฑู)**:
   - ูู ุจุฅุถุงูุฉ `FCM_PROJECT_ID` ุฅุฐุง ุฃุฑุฏุช ุฌุนู ุงูู ID ุฏููุงููููุงู (ุญุงููุงู ุงูููุฏ ูุนุชูุฏ ุนูู ุงูููู ูุจุงุดุฑุฉ ููู ููุถู ูุถุนู ูู config).

---

## ๐ฑ **ุชุญุฏูุซ Token ุงููุณุชุฎุฏู (ูู ุงูููุจุงูู):**

ุนูุฏ ุฏุฎูู ุงููุณุชุฎุฏู ููุชุทุจูู (Login)ุ ูุฌุจ ุฅุฑุณุงู ุงูู FCM Token ุงูุฎุงุต ุจุฌูุงุฒู ุฅูู ุงูุณูุฑูุฑ:

**Endpoint:**
```http
POST /api/notifications/update-token
```

**Headers:**
```
Authorization: Bearer {token}
```

**Body:**
```json
{
  "fcm_token": "token_from_firebase_sdk_on_mobile_..."
}
```

---

## ๐๏ธ **ุณููุงุฑูููุงุช ุงูุฅุดุนุงุฑุงุช ุงูููุนูุฉ:**

### 1๏ธโฃ ุนูุฏ ุงุณุชูุงู ุฑุณุงูุฉ ุฌุฏูุฏุฉ (Chat)
- **ุงูููุงู:** `ChatController`
- **ุงูุขููุฉ:** ุจูุฌุฑุฏ ุฅุฑุณุงู ุฑุณุงูุฉุ ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุณุชูู.
- **ูุญุชูู ุงูุฅุดุนุงุฑ:**
  - ุงูุนููุงู: "ุฑุณุงูุฉ ุฌุฏูุฏุฉ ูู [ุงุณู ุงููุฑุณู]"
  - ุงููุต: ูุต ุงูุฑุณุงูุฉ ุฃู "๐ท ุตูุฑุฉ ุฌุฏูุฏุฉ"

### 2๏ธโฃ ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู (ูููุทูุฑูู)
- **Endpoint:** `POST /api/notifications/send-test`
- **Body:** `{ "title": "Test", "body": "Hello World" }`

---

## ๐ป **ููููุฉ ุงุณุชุฎุฏุงู ุงูุฎุฏูุฉ ูู ุงูููุฏ:**

ููููู ุงุณุชุฏุนุงุก ุฎุฏูุฉ `FCMService` ูู ุฃู ููุงู ูู ุงูููุฏ (Controllers, Events, Jobs):

```php
use App\Services\FCMService;

// ุญูู ุงูุฎุฏูุฉ
public function myFunction(FCMService $fcmService) {
    
    // ุฅุฑุณุงู ููุณุชุฎุฏู ูุนูู
    $fcmService->sendToUser($userId, 'ุนููุงู ุงูุฅุดุนุงุฑ', 'ูุต ุงูุฑุณุงูุฉ');

    // ุฅุฑุณุงู ูููู (ูุชุทูุจ ุงุดุชุฑุงููู ูู Topic 'all_users' ูู ุงูููุจุงูู)
    $fcmService->sendToAll('ุชุญุฏูุซ ุฌุฏูุฏ!', 'ุชู ุฅุถุงูุฉ ุจุงูุงุช ุฌุฏูุฏุฉ ูููุฒุฉ ๐');
}
```

---

## ๐ **ุงูุฎุทูุงุช ุงููุงุฏูุฉ:**

1. **ุฅุดุนุงุฑุงุช ุงูุจุงูุงุช:**
   - ุนูุฏ ุฅูุดุงุก ุจุงูุฉ ุฌุฏูุฏุฉ ูู Filamentุ ููููู ุฅุถุงูุฉ Hook ูุฅุฑุณุงู `sendToAll`.

2. **ุฅุดุนุงุฑุงุช ุงูุฑุตูุฏ:**
   - ููููู ุฅูุดุงุก Scheduled Job (Cron Job) ููุญุต ุงูุฃุฑุตุฏุฉ ููููุงู ููุฑุณู ููู ุฑุตูุฏู ุฃูู ูู ุญุฏ ูุนูู.

3. **ุฅุดุนุงุฑุงุช ุงูุชุทุงุจู:**
   - ุนูุฏ ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏุ ูู ุจุงูุจุญุซ ุนู ูุณุชุฎุฏููู ูุฏููู ููุณ ุงูููุงูุงุช ูุงุณุชุฎุฏู `sendToUsers`.

ุชู ุงูุชุฌููุฒ! ๐๐
