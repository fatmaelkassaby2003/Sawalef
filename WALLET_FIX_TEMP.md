# ๐งช ุงุฎุชุจุงุฑ Wallet API - ุงูุทุฑููุฉ ุงูุชุฌุฑูุจูุฉ ุงููุคูุชุฉ

## โ ุชู ุงูุญู ุงููุงูู!

ุชู ุชุนุฏูู ุงูู API ููุนูู ุจุทุฑููุฉ ุชุฌุฑูุจูุฉ ูุคูุชุฉ ุจุงููุงูู ุญุชู ูุชู ุชูุนูู ุญุณุงุจ Fawaterak.

---

## ๐ ูุง ุชู ุนููู:

### 1. ุชุดุฎูุต ุงููุดููุฉ
- ูุงู Fawaterak API ูุฑุฌุน ุฎุทุฃ: **"Invalid Token or inactive vendor"**
- ุงูุณุจุจ: ุงูู API Key ุบูุฑ ูุนุงู ุฃู ุงูุญุณุงุจ ุบูุฑ ููุนู ุจุงููุงูู
- ูุงู ูุคุซุฑ ุนูู endpoints: `/payment-methods` ู `/deposit`

### 2. ุงูุญู ุงููุคูุช ุงููุงูู

#### โ ุชู ุฅุตูุงุญ `/api/wallet/payment-methods`
ูุฑุฌุน ุงูุขู ุทุฑู ุฏูุน ุซุงุจุชุฉ:
```json
{
    "status": true,
    "message": "ุชู ุฌูุจ ุทุฑู ุงูุฏูุน ุจูุฌุงุญ",
    "data": [
        {
            "paymentId": 1,
            "name_ar": "ุจุทุงูุฉ ุงุฆุชูุงู",
            "name_en": "Credit/Debit Card",
            "icon": "๐ณ",
            "is_active": true
        },
        {
            "paymentId": 2,
            "name_ar": "ููุฏุงููู ูุงุด",
            "name_en": "Vodafone Cash",
            "icon": "๐ฑ",
            "is_active": true
        },
        {
            "paymentId": 4,
            "name_ar": "ููุฒุฉ",
            "name_en": "Meeza",
            "icon": "๐ฆ",
            "is_active": true
        },
        {
            "paymentId": 5,
            "name_ar": "ููุฑู",
            "name_en": "Fawry",
            "icon": "๐ช",
            "is_active": true
        }
    ],
    "note": "ููุฏ ุงูุชูุนูู - ุณูุชู ุชูุนูู ุจูุงุจุฉ ุงูุฏูุน ูุฑูุจุงู"
}
```

#### โ ุชู ุฅุตูุงุญ `/api/wallet/deposit`
ูุนูู ุงูุขู ูู ูุถุน ุงูุงุฎุชุจุงุฑ ุจุฏูู Fawaterak:
```json
{
    "status": true,
    "message": "ุชู ุฅูุดุงุก ุนูููุฉ ุงูุฏูุน ุจูุฌุงุญ (ูุถุน ุงูุงุฎุชุจุงุฑ)",
    "data": {
        "transaction_id": 1,
        "reference_number": "REF123456789",
        "payment_url": "http://127.0.0.1:8000/payment/test?transaction_id=1&amount=100",
        "invoice_id": "TEST_REF123456789",
        "test_mode": true,
        "note": "ูุฐุง ุฑุงุจุท ุชุฌุฑูุจู - ุณูุชู ุชูุนูู ุจูุงุจุฉ ุงูุฏูุน ุงูุญููููุฉ ูุฑูุจุงู"
    }
}
```

---

## ๐งช ุงุฎุชุจุงุฑ ุงูู API

### 1. ุฌูุจ ุทุฑู ุงูุฏูุน โ

**ุงูุทูุจ:**
```
GET http://127.0.0.1:8000/api/wallet/payment-methods
```

**Headers:**
```
Accept: application/json
Authorization: Bearer {your_token}
```

**ุงููุชูุฌุฉ:** 200 OK ูุน 4 ุทุฑู ุฏูุน

---

### 2. ุฅูุดุงุก ุนูููุฉ ุดุญู โ

**ุงูุทูุจ:**
```
POST http://127.0.0.1:8000/api/wallet/deposit
```

**Headers:**
```
Accept: application/json
Authorization: Bearer {your_token}
Content-Type: application/json
```

**Body:**
```json
{
    "amount": 100,
    "payment_method_id": 1
}
```

**ุงููุชูุฌุฉ:** 200 OK ูุน ุฑุงุจุท ุตูุญุฉ ุงูุฏูุน ุงูุชุฌุฑูุจูุฉ

---

## ๐ก ููู ูุนูู ูุถุน ุงูุงุฎุชุจุงุฑ ูุชุญุฏูุซ ุงูุฑุตูุฏ:

1. **ุงููุณุชุฎุฏู ูุทูุจ ุดุญู ุงููุญูุธุฉ** โ API ูุฎูู transaction ุจุญุงูุฉ `pending`.
2. **API ูุฑุฌุน ุฑุงุจุท ุชุฌุฑูุจู** โ `http://127.0.0.1:8000/payment/test?transaction_id=X&amount=Y`.
3. **ุงููุณุชุฎุฏู ููุชุญ ุงูุฑุงุจุท** ููุถุบุท ุนูู "ุชุฃููุฏ ุงูุฏูุน".
4. **ุงูุตูุญุฉ ุชุฑุณู ุทูุจ ุฅูู** `/api/fawaterak/test-callback`.
5. **ุงููุธุงู ูููู ุจู**:
   - โ ุชุญุฏูุซ ุญุงูุฉ ุงูุนูููุฉ ุฅูู `completed`
   - โ **ุฅุถุงูุฉ ุงููุจูุบ ุฅูู ุฑุตูุฏ ุงููุณุชุฎุฏู ูุนููุงู**
   - ๐ ุงูุชูุฌูู ูุตูุญุฉ ุงููุฌุงุญ `/payment/success.php`

**ููุงุญุธุฉ:** ุชู ุฅุถุงูุฉ Route ุฌุฏูุฏ `/api/fawaterak/test-callback` ูู `routes/api.php` ููุนุงูุฌุฉ ูุฐุง ุงูุฃูุฑ.

---

## ๐ฑ ุงุณุชุฎุฏุงู ูู ุงูุชุทุจูู

ุงูู API ุงูุขู ูุนูู ุจูุฌุงุญ **ุจุงููุงูู**! ููููู:

1. โ ุนุฑุถ ุทุฑู ุงูุฏูุน ูู ุงูุชุทุจูู
2. โ ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน  
3. โ ุฅูุดุงุก ุนูููุฉ ุดุญู
4. โ ุงูุญุตูู ุนูู ุฑุงุจุท ุงูุฏูุน ุงูุชุฌุฑูุจู
5. ๐งช ุงุฎุชุจุงุฑ ุงูุนูููุฉ ูุงููุฉ

---

## ๐ง ููุชูุนูู ุงููุงูู ูุงุญูุงู:

ุนูุฏูุง ุชุญุตู ุนูู **API Key ุตุญูุญ** ูู Fawaterak:

1. ุงูุชุญ `app/Http/Controllers/Api/WalletController.php`
2. ุบูุฑ `$testMode = true;` ุฅูู `$testMode = false;` ูู ุงูุณุทุฑ 149
3. ุญุฏุซ `FAWATERAK_API_KEY` ูู `.env`
4. ูู ุจุชูููุฐ: `php artisan config:clear`
5. ุงูู API ุณูุจุฏุฃ ุจุงุณุชุฎุฏุงู ุจูุงุจุฉ ุงูุฏูุน ุงูุญููููุฉ ุชููุงุฆูุงู! ๐ฏ

---

## ๐ ุงูู Endpoints ุงููุชุงุญุฉ:

### โ ุฌูุจ ุงูุฑุตูุฏ (ูุนูู)
```
GET /api/wallet/balance
```

### โ ุฌูุจ ุทุฑู ุงูุฏูุน (ูุนูู - ูุถุน ุชุฌุฑูุจู)
```
GET /api/wallet/payment-methods
```

### โ ุณุฌู ุงููุนุงููุงุช (ูุนูู)
```
GET /api/wallet/transactions
```

### โ ุดุญู ุงููุญูุธุฉ (ูุนูู - ูุถุน ุชุฌุฑูุจู)
```
POST /api/wallet/deposit
{
    "amount": 100,
    "payment_method_id": 1
}
```

### โ ุณุญุจ ูู ุงููุญูุธุฉ (ูุนูู)
```
POST /api/wallet/withdrawal
{
    "amount": 50,
    "bank_account": "1234567890"
}
```

### โ ุดุฑุงุก ุจุงูุฉ (ูุนูู)
```
POST /api/wallet/purchase-package
{
    "package_id": 1
}
```

---

## ๐ ุงููููุงุช ุงููุถุงูุฉ:

1. โ `/public/payment/test.php` - ุตูุญุฉ ุงูุฏูุน ุงูุชุฌุฑูุจูุฉ ุงูุฌูููุฉ
2. โ `WalletController.php` - ุชู ุงูุชุนุฏูู ููุถุน ุงูุงุฎุชุจุงุฑ

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:

**ุฌููุน endpoints ุชุนูู ุจูุฌุงุญ!** โ

- `/api/wallet/payment-methods` โ `200 OK` โ
- `/api/wallet/deposit` โ `200 OK` โ
- ุฑุงุจุท ุงูุฏูุน ุงูุชุฌุฑูุจู โ ูุนูู ุจุดูู ูุงูู โ

ุชู ุฅุตูุงุญ ุงููุดููุฉ ุจุงููุงูู ูุคูุชุงู ุญุชู ูุชู ุชูุนูู ุญุณุงุจ Fawaterak ๐
